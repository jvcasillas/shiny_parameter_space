[{"name":"app.R","content":"#\n# This is a Shiny web application. You can run the application by clicking\n# the 'Run App' button above.\n#\n# Find out more about building applications with Shiny here:\n#\n#    http://shiny.rstudio.com/\n#\n#\n#\n\n# Load packages\nlibrary(\"shiny\")\nlibrary(\"ggplot2\")\nlibrary(\"tidyr\")\nlibrary(\"dplyr\")\nlibrary(\"broom\")\nlibrary(\"patchwork\")\nlibrary(\"bslib\")\n\n# shinylive::export(\"app\", \"docs\")\n\ntheme <- bs_theme(\n  # Controls the default grayscale palette\n  bg = \"#fff\", fg = \"#202123\",\n  # Controls the accent (e.g., hyperlink, button, etc) colors\n  primary = \"#cc0033\", secondary = \"#48DAC6\",\n  base_font = c(\"Grandstander\", \"sans-serif\"),\n  code_font = c(\"Courier\", \"monospace\"),\n  heading_font = \"'Helvetica Neue', Helvetica, sans-serif\",\n  # Can also add lower-level customization\n  \"input-border-color\" = \"#cc0033\"\n)\n\n# Set theme for ggplot\nparam_theme <- function(...) {\n  list(\n    theme_bw(...), \n    theme(\n      panel.grid.major = element_line(linewidth = 0.2),\n      panel.grid.minor = element_line(linewidth = 0.2)\n    )\n  )\n}\n\n\n# Define UI for application that draws a histogram\nui <- fluidPage(\n    theme = theme, \n    # Application title\n    titlePanel(\"Exploring parameter space\", windowTitle = \"Parameter space\"),\n    # Sidebar with a slider input for number of bins \n    sidebarLayout(\n        sidebarPanel(width = 3, \n          withMathJax(),\n            p(\"$$y_i \\\\sim Normal(\\\\mu_i, \\\\sigma)$$\"), \n            p(\"$$\\\\mu_i = \\\\alpha + \\\\beta x_i$$\"), \n            br(), \n            sliderInput(\n              inputId = \"b_0\",\n              label = \"Intercept\",\n              min = -1.5, max = 1.5, value = 0, step = 0.1, ticks = F), \n            sliderInput(\n              inputId = \"b_1\",\n              label = \"Slope\",\n              min = -1.5, max = 1.5, value = 0.5, step = 0.1, ticks = F),\n            br(), \n            p(strong(\"Created by:\"), \n              tags$a(\"Joseph V. Casillas\", href=\"https://www.jvcasillas.com\"),\n            br(), \n            strong(\"Source code:\"), \n              tags$a(\"Github\", href=\"https://github.com/jvcasillas/shiny_parameters/\"))\n        ),\n\n        # Show a plot of the generated distribution\n        mainPanel(width = 9, br(), \n           plotOutput(\"distPlot\")\n        )\n    )\n)\n\n# Define server logic required to draw a histogram\nserver <- function(input, output) {\n\n    n <- 25\n    x <- rnorm(n, 0, 1)\n    \n    output$distPlot <- renderPlot({\n        # generate data\n        dat <- tibble(\n          x = x, \n          y = input$b_0 + (x * input$b_1) + rnorm(n, 0, 1)\n        )\n\n        # Fit model\n        mod <- lm(y ~ x, data = dat)\n\n        # Data space plot\n        p1 <- augment(mod) |> \n          ggplot() + \n          aes(x = x, y = y) + \n          geom_vline(xintercept = 0, lty = 3) + \n          geom_hline(yintercept = 0, lty = 3) + \n          geom_point(aes(fill = .resid), pch = 21, size = 4, show.legend = F) + \n          scale_fill_gradient2() + \n          geom_abline(intercept = coef(mod)[1], slope = coef(mod)[2], \n            color = \"#cc0033\", linewidth = 1.2) + \n          coord_cartesian(xlim = c(-2.5, 2.5), ylim = c(-2.5, 2.5)) + \n          labs(title = \"Data space\") + \n          param_theme(base_size = 16)\n\n        # Parameter space plot\n        p2 <- ggplot(data = tibble(x = input$b_1, y = input$b_0)) + \n          aes(x = x, y = y) + \n          geom_vline(xintercept = input$b_1, lty = 3) + \n          geom_hline(yintercept = input$b_0, lty = 3) + \n          geom_point(size = 8, color = \"#cc0033\") + \n          coord_cartesian(xlim = c(-2.5, 2.5), ylim = c(-2.5, 2.5)) + \n          scale_y_continuous(position = \"right\") + \n          labs(title = \"Parameter space\", y = \"Intercept\", x = \"Slope\") + \n          param_theme(base_size = 16)\n\n        # Print plots together\n        p1 + p2\n    })\n}\n\n# Run the application \nshinyApp(ui = ui, server = server)\n","type":"text"}]
